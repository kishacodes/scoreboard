function r(n){return String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/'/g,"&#39;")}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".game-card[data-game-id]").forEach(n=>{const s=n,l=s.getAttribute("data-game-id"),t=s.querySelector(".updates-details");if(!t||!l)return;const e=s.querySelector(".updates-list"),d=s.querySelector(".updates-heading");t.addEventListener("toggle",async()=>{if(t.open&&t.getAttribute("data-loaded")!=="true")try{const i=await fetch(`/api/games/${l}/updates`),a=i.ok?await i.json():[];if(d&&(d.textContent=a.length>0?`Recent Updates (${a.length})`:"Recent Updates (0)"),!e)return;!a||a.length===0?e.innerHTML='<li class="update-item"><div class="update-row"><span class="update-text">No updates yet</span><span class="update-timestamp"></span></div></li>':e.innerHTML=a.map(p=>`<li class="update-item"><div class="update-row"><span class="update-text" title="${r(p.update_text)}">${r(p.update_text)}</span><span class="update-timestamp">${r(p.created_at)}</span></div></li>`).join(""),t.setAttribute("data-loaded","true")}catch{d&&(d.textContent="Recent Updates (0)"),e&&(e.innerHTML='<li class="update-item"><div class="update-row"><span class="update-text">No updates yet</span><span class="update-timestamp"></span></div></li>'),t.setAttribute("data-loaded","true")}})})});
